<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate</title>
    <link rel="stylesheet" href="certificate.css"> <!-- Link to external CSS -->
</head>
<body>

    <nav id="desktop-nav">
        <div class="logo">
            <img src="./assets/jrv.png" alt="Logo" class="logo-img">
        </div>
        <div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#about">About</a></li> <!-- Updated this link -->
                <li><a href="index.html#experience">Skills</a></li>
                <li><a href="projects.html">Projects</a></li>
                <li><a href="index.html#contact">Contact</a></li>
                <li><a href="certificate.html">Certificate</a></li>
            </ul>
        </div>
        
    </nav>

    <main>
        <h1>My Certificates</h1>
        <div class="certificate-container">
            <div class="certificate-card">
                <img src="./assets/HTML_CERTIFICATE_JohnRicVista.jpg" alt="Certificate 1" class="certificate-img" onclick="openModal(this)">
                <h2>HTML - The Complete Guide</h2>
                <p>Issued by Organization: UDEMY</p>
            </div>
            <div class="certificate-card">
                <img src="./assets/CSS, JAVASCRIPT, PHP_CERT.jpg" alt="Certificate 2" class="certificate-img" onclick="openModal(this)">
                <h2>CSS, JAVASCRIPT, PHP</h2>
                <p>Issued by Organization: UDEMY</p>
            </div>
            <div class="certificate-card">
                <img src="./assets/HTML5 & CSS3 Complete Course.jpg" alt="Certificate 3" class="certificate-img" onclick="openModal(this)">
                <h2>HTML5 & CSS3 Complete Course</h2>
                <p>Issued by Organization: UDEMY</p>
            </div>
            <!-- Add more certificate cards as needed -->
        </div>
    </main>

    <h2>-----More Certificates to be followed-----</h2>

    <!-- Modal for enlarged image -->
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="img01">
        <div id="caption"></div>
    </div>

    <script src="certificate.js"></script> <!-- Link to external JavaScript -->
    <h2>orig prompt</h2>
    <p>Here is the detailed web app I want to create in appscript. The project called 'Pulse' where it calculates the total production time of an employees. This have so many calculations but let's skip that part and focus on the structure of the webapp. First in have 3 filter button named 'Project', 'Manager', and 'S4'. When you choose a Project, Manager and S4 that under that Project will only show on that filter. When you choose on Manager, project and S4 under him/her will only show on that filter. And when you choose on S4, Project that under him/her will only show on that filter and Manager that is he/she part of will only show on that filter. It is like cascading style. Second is Date filter button with 'From' and 'To'. Third is the 'Apply' button where it needs to click first to get what the users want to see and last is 'Clear' button to clear all the filters and reset to normal. You can get the list of Projects, Managers, S4 and employees on google sheet (gsheets Id example only: 170CORmjNk__GrTOwm06KuMaR9JrbFFUkAbn921B-pKA) sheet named 'List' all of the details is there.

On the calculation part (let's skip that part because I need confirmation how will it do, just put a blank there), let's get first the data I need. Use this google sheets (example only, not the actual google sheet id: 170CORmjNk__GrTOwm06KuMaR9JrbFFUkAbn921B-pKA)to get the Vali Prod Count and Veri Prod Count on this google sheet use the 'CONSOLIDATED' sheet named. In this sheet there is Column A = Date, Column B = NAME, Column C = INVOICE NUMBER, Column D = PAGES, Column E = DOCUMENT, Column F = VALIDATION/VERIFICATION. <br> <br> To get the Vali Prod Count of Employees you shoud use total of Column E and Column F should be VALIDATION, For Veri Prod Count it is the same but Column F should be VERIFICATION.

To get the Vali Prod Hours and Veri Prod Hours use this google sheet (google sheet ID for production hours) use the sheet named 'LOG'. In 'LOG' to get the Vali Prod Hours the Activity should be in Production and the Notes should be TRICOR- VALI and for Vali Prod Hours the Activity Should be Production and the Notes should be TRICOR- veri. And add some regex to TRICOR- VALI and TRICOR- veri. <br> <br>

When the date filter button is used, that choose date range should also add the Vali Prod Count, Vali Prod Hours, Veri Prod Count, Veri Prod Hours. For example the date picked is from Jan. 1, 2026 to Jan. 10, 2026 the Vali Prod Count, Vali Prod Hours, Veri Prod Count, Veri Prod Hours should be totaled from that ranges.

The Default page or Landing page should show all the employees even they are on different projects.<br><br>

And When the user click 'Apply' button this when the magic happens, there will be a charts on right side, is still possible to use combo charts For Vali Prod Count, Vali Prod Hours, Veri Prod Count, Veri Prod Hours, so It will be two charts.

</p>

<h1>HTML</h1>
<p><pre><code>
    &lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;base target=&quot;_top&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;title&gt;Pulse - Production Tracker&lt;/title&gt;
  
  &lt;!-- Google Charts --&gt;
  &lt;script type=&quot;text/javascript&quot; src=&quot;https://www.gstatic.com/charts/loader.js&quot;&gt;&lt;/script&gt;
  
  &lt;!-- Font Awesome for Icons --&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css&quot;&gt;
  
  &lt;style&gt;
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .logo {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 28px;
      font-weight: 700;
      padding: 15px 25px;
      border-radius: 15px;
      letter-spacing: 2px;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .logo i {
      font-size: 24px;
    }
    
    .logo span {
      font-size: 16px;
      font-weight: 400;
      margin-left: 10px;
      opacity: 0.9;
    }
    
    /* Improved Filter Section */
    .filter-section {
      background: linear-gradient(135deg, #f5f7fa 0%, #e9ecf1 100%);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    
    .filter-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .filter-header i {
      font-size: 20px;
      color: #667eea;
      background: white;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .filter-header h3 {
      color: #333;
      font-size: 18px;
      font-weight: 600;
    }
    
    /* Improved Filter Grid - Better Placement */
    .filter-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .filter-group {
      display: flex;
      flex-direction: column;
      background: white;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }
    
    .filter-group:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
    }
    
    .filter-group label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      color: #2a5298;
      margin-bottom: 10px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .filter-group label i {
      font-size: 16px;
      color: #667eea;
    }
    
    .filter-group select, .filter-group input {
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 14px;
      transition: all 0.3s;
      background: white;
      width: 100%;
    }
    
    .filter-group select:focus, .filter-group input:focus {
      border-color: #667eea;
      outline: none;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .filter-group select.auto-populated {
      background-color: #e8f0fe;
      border-color: #667eea;
      font-weight: 600;
    }
    
    /* Improved Date Range */
    .date-range {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .date-input {
      flex: 1;
      position: relative;
    }
    
    .date-input i {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #667eea;
      font-size: 14px;
      z-index: 1;
    }
    
    .date-input input {
      width: 100%;
      padding: 12px 15px 12px 35px;
    }
    
    .date-input input.error {
      border-color: #ff4757;
      background-color: #fff8f8;
    }
    
    .date-error-message {
      font-size: 11px;
      color: #ff4757;
      margin-top: 5px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    /* Action Buttons - Better Placement */
    .action-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px dashed #d0d7e7;
    }
    
    .filter-hint {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #666;
      font-size: 13px;
      background: rgba(102, 126, 234, 0.1);
      padding: 8px 15px;
      border-radius: 30px;
    }
    
    .filter-hint i {
      color: #667eea;
    }
    
    .button-group {
      display: flex;
      gap: 12px;
    }
    
    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }
    
    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: #ff4757;
      color: white;
      box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3);
    }
    
    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 71, 87, 0.4);
    }
    
    /* Auto-populate indicator */
    .auto-hint {
      font-size: 11px;
      color: #667eea;
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 4px;
      background: rgba(102, 126, 234, 0.08);
      padding: 4px 8px;
      border-radius: 20px;
    }
    
    .auto-hint i {
      font-size: 10px;
    }
    
    /* Main Content - Full Width Initially */
    .main-content {
      width: 100%;
    }
    
    /* Table Section - Full Width */
    .table-section {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      width: 100%;
      transition: all 0.3s ease;
    }
    
    /* When charts are visible, split the layout */
    .main-content.with-charts {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 25px;
    }
    
    .table-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px 20px;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .table-header i {
      margin-right: 8px;
    }
    
    .table-container {
      overflow-x: auto;
      max-height: 500px;
      overflow-y: auto;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 800px;
    }
    
    th {
      background: #f8f9fa;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      color: #2a5298;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    td {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
    }
    
    tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    tr:hover {
      background: #f1f3f4;
    }
    
    .project-badge {
      background: #667eea;
      color: white;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: inline-block;
    }
    
    /* Charts Section - Hidden Initially */
    .charts-section {
      display: none;
    }
    
    /* When charts are visible */
    .charts-section.visible {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .chart-card {
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      height: 320px;
      display: flex;
      flex-direction: column;
    }
    
    .chart-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 16px;
      font-weight: 600;
      color: #333;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .chart-title i {
      color: #667eea;
    }
    
    .chart-container {
      width: 100%;
      flex: 1;
      min-height: 240px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f9f9f9;
      border-radius: 10px;
      overflow: visible;
    }
    
    .chart-placeholder {
      color: #999;
      font-style: italic;
      text-align: center;
      padding: 30px;
      font-size: 14px;
    }
    
    .pagination {
      display: flex;
      justify-content: flex-end;
      gap: 5px;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #eee;
      flex-wrap: wrap;
    }
    
    .page-btn {
      padding: 8px 12px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.2s;
      min-width: 35px;
    }
    
    .page-btn:hover:not(:disabled) {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    .page-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .loader {
      border: 5px solid #f3f3f3;
      border-top: 5px solid #667eea;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .no-data {
      text-align: center;
      padding: 50px;
      color: #666;
      font-style: italic;
    }
    
    .status-message {
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      text-align: center;
    }
    
    .status-success {
      background: #d4edda;
      color: #155724;
    }
    
    .status-error {
      background: #f8d7da;
      color: #721c24;
    }
    
    .apply-hint {
      text-align: center;
      padding: 15px;
      background: #fff3cd;
      color: #856404;
      border-radius: 8px;
      margin: 10px 0 20px;
      font-size: 14px;
      border-left: 4px solid #ffc107;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .apply-hint i {
      color: #f59e0b;
    }
    
    @media (max-width: 1200px) {
      .filter-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .main-content.with-charts {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .filter-grid {
        grid-template-columns: 1fr;
      }
      
      .date-range {
        flex-direction: column;
      }
      
      .action-bar {
        flex-direction: column;
        align-items: stretch;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
        justify-content: center;
      }
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class=&quot;container&quot;&gt;
    &lt;!-- Header with Logo --&gt;
    &lt;div class=&quot;header&quot;&gt;
      &lt;div class=&quot;logo&quot;&gt;
        &lt;i class=&quot;fas fa-chart-line&quot;&gt;&lt;/i&gt;
        PULSE
        &lt;span&gt;Production Tracker&lt;/span&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;!-- Filter Section --&gt;
    &lt;div class=&quot;filter-section&quot;&gt;
      &lt;div class=&quot;filter-header&quot;&gt;
        &lt;i class=&quot;fas fa-sliders-h&quot;&gt;&lt;/i&gt;
        &lt;h3&gt;Filter Controls&lt;/h3&gt;
      &lt;/div&gt;
      
      &lt;div class=&quot;filter-grid&quot;&gt;
        &lt;!-- Project Filter --&gt;
        &lt;div class=&quot;filter-group&quot;&gt;
          &lt;label&gt;
            &lt;i class=&quot;fas fa-folder&quot;&gt;&lt;/i&gt;
            PROJECT
          &lt;/label&gt;
          &lt;select id=&quot;projectFilter&quot; onchange=&quot;updateFilterOptions('project')&quot;&gt;
            &lt;option value=&quot;ALL&quot;&gt;All Projects&lt;/option&gt;
          &lt;/select&gt;
          &lt;div id=&quot;projectAutoHint&quot; class=&quot;auto-hint&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- Manager Filter --&gt;
        &lt;div class=&quot;filter-group&quot;&gt;
          &lt;label&gt;
            &lt;i class=&quot;fas fa-user-tie&quot;&gt;&lt;/i&gt;
            MANAGER
          &lt;/label&gt;
          &lt;select id=&quot;managerFilter&quot; onchange=&quot;updateFilterOptions('manager')&quot;&gt;
            &lt;option value=&quot;ALL&quot;&gt;All Managers&lt;/option&gt;
          &lt;/select&gt;
          &lt;div id=&quot;managerAutoHint&quot; class=&quot;auto-hint&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- S4 Filter --&gt;
        &lt;div class=&quot;filter-group&quot;&gt;
          &lt;label&gt;
            &lt;i class=&quot;fas fa-building&quot;&gt;&lt;/i&gt;
            S4
          &lt;/label&gt;
          &lt;select id=&quot;s4Filter&quot; onchange=&quot;updateFilterOptions('s4')&quot;&gt;
            &lt;option value=&quot;ALL&quot;&gt;All S4&lt;/option&gt;
          &lt;/select&gt;
          &lt;div id=&quot;s4AutoHint&quot; class=&quot;auto-hint&quot;&gt;&lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- Date Range --&gt;
        &lt;div class=&quot;filter-group&quot;&gt;
          &lt;label&gt;
            &lt;i class=&quot;fas fa-calendar-alt&quot;&gt;&lt;/i&gt;
            DATE RANGE
          &lt;/label&gt;
          &lt;div class=&quot;date-range&quot;&gt;
            &lt;div class=&quot;date-input&quot;&gt;
              &lt;i class=&quot;fas fa-calendar-plus&quot;&gt;&lt;/i&gt;
              &lt;input type=&quot;date&quot; id=&quot;fromDate&quot; onchange=&quot;validateDates()&quot;&gt;
            &lt;/div&gt;
            &lt;div class=&quot;date-input&quot;&gt;
              &lt;i class=&quot;fas fa-calendar-check&quot;&gt;&lt;/i&gt;
              &lt;input type=&quot;date&quot; id=&quot;toDate&quot; onchange=&quot;validateDates()&quot;&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          &lt;div id=&quot;dateErrorMessage&quot; class=&quot;date-error-message&quot; style=&quot;display: none;&quot;&gt;
            &lt;i class=&quot;fas fa-exclamation-circle&quot;&gt;&lt;/i&gt;
            &lt;span&gt;From date cannot be later than To date&lt;/span&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;!-- Action Bar --&gt;
      &lt;div class=&quot;action-bar&quot;&gt;
        &lt;div class=&quot;filter-hint&quot;&gt;
          &lt;i class=&quot;fas fa-info-circle&quot;&gt;&lt;/i&gt;
          &lt;span&gt;Select filters then click Apply&lt;/span&gt;
        &lt;/div&gt;
        
        &lt;div class=&quot;button-group&quot;&gt;
          &lt;button class=&quot;btn btn-primary&quot; onclick=&quot;applyFilters()&quot; id=&quot;applyButton&quot;&gt;
            &lt;i class=&quot;fas fa-check&quot;&gt;&lt;/i&gt; Apply
          &lt;/button&gt;
          &lt;button class=&quot;btn btn-secondary&quot; onclick=&quot;clearFilters()&quot;&gt;
            &lt;i class=&quot;fas fa-times&quot;&gt;&lt;/i&gt; Clear
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;!-- Status Message --&gt;
      &lt;div id=&quot;statusMessage&quot; class=&quot;status-message&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
    
    &lt;!-- Apply Hint --&gt;
    &lt;div id=&quot;applyHint&quot; class=&quot;apply-hint&quot;&gt;
      &lt;i class=&quot;fas fa-magic&quot;&gt;&lt;/i&gt;
      &lt;span&gt;Click Apply to generate charts based on your filters&lt;/span&gt;
    &lt;/div&gt;
    
    &lt;!-- Main Content --&gt;
    &lt;div class=&quot;main-content&quot; id=&quot;mainContent&quot;&gt;
      &lt;!-- Table Section --&gt;
      &lt;div class=&quot;table-section&quot;&gt;
        &lt;div class=&quot;table-header&quot;&gt;
          &lt;span&gt;
            &lt;i class=&quot;fas fa-table&quot;&gt;&lt;/i&gt;
            Production Summary
          &lt;/span&gt;
          &lt;span id=&quot;recordCount&quot;&gt;0 records&lt;/span&gt;
        &lt;/div&gt;
        
        &lt;div id=&quot;loader&quot; class=&quot;loader&quot; style=&quot;display: none;&quot;&gt;&lt;/div&gt;
        
        &lt;div class=&quot;table-container&quot; id=&quot;tableContainer&quot;&gt;
          &lt;table&gt;
            &lt;thead&gt;
              &lt;tr&gt;
                &lt;th&gt;PROJECT&lt;/th&gt;
                &lt;th&gt;Name&lt;/th&gt;
                &lt;th&gt;Vali Prod Count&lt;/th&gt;
                &lt;th&gt;Vali Prod Hours&lt;/th&gt;
                &lt;th&gt;Veri Prod Count&lt;/th&gt;
                &lt;th&gt;Veri Prod Hours&lt;/th&gt;
              &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody id=&quot;tableBody&quot;&gt;
              &lt;tr&gt;
                &lt;td colspan=&quot;6&quot; class=&quot;no-data&quot;&gt;
                  &lt;i class=&quot;fas fa-spinner fa-pulse&quot;&gt;&lt;/i&gt; Loading employees...
                &lt;/td&gt;
              &lt;/tr&gt;
            &lt;/tbody&gt;
          &lt;/table&gt;
        &lt;/div&gt;
        
        &lt;!-- Pagination --&gt;
        &lt;div class=&quot;pagination&quot; id=&quot;pagination&quot;&gt;&lt;/div&gt;
      &lt;/div&gt;
      
      &lt;!-- Charts Section --&gt;
      &lt;div class=&quot;charts-section&quot; id=&quot;chartsSection&quot;&gt;
        &lt;!-- Validation Chart --&gt;
        &lt;div class=&quot;chart-card&quot;&gt;
          &lt;div class=&quot;chart-title&quot;&gt;
            &lt;i class=&quot;fas fa-check-circle&quot; style=&quot;color: #667eea;&quot;&gt;&lt;/i&gt;
            Validation Production
          &lt;/div&gt;
          &lt;div id=&quot;validationChart&quot; class=&quot;chart-container&quot;&gt;
            &lt;div class=&quot;chart-placeholder&quot;&gt;
              &lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;
              &lt;p&gt;Charts appear after clicking Apply&lt;/p&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- Verification Chart --&gt;
        &lt;div class=&quot;chart-card&quot;&gt;
          &lt;div class=&quot;chart-title&quot;&gt;
            &lt;i class=&quot;fas fa-search&quot; style=&quot;color: #4CAF50;&quot;&gt;&lt;/i&gt;
            Verification Production
          &lt;/div&gt;
          &lt;div id=&quot;verificationChart&quot; class=&quot;chart-container&quot;&gt;
            &lt;div class=&quot;chart-placeholder&quot;&gt;
              &lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;
              &lt;p&gt;Charts appear after clicking Apply&lt;/p&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;script&gt;
    // Global variables
    let allRelationships = [];
    let allFilterOptions = {
      projects: [],
      managers: [],
      s4s: []
    };
    let currentFilters = {
      project: 'ALL',
      manager: 'ALL',
      s4: 'ALL'
    };
    let currentPage = 1;
    const rowsPerPage = 10;
    let currentData = [];
    let chartsVisible = false;
    
    // Initialize Google Charts with callback
    google.charts.load('current', { 
      packages: ['corechart', 'bar'],
      callback: function() {
        console.log('Google Charts loaded');
        init();
      }
    });
    
    function init() {
      setDefaultDates();
      loadFilterOptions();
    }
    
    function setDefaultDates() {
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const day = String(today.getDate()).padStart(2, '0');
      const todayStr = `${year}-${month}-${day}`;
      
      document.getElementById('fromDate').value = todayStr;
      document.getElementById('toDate').value = todayStr;
    }
    
    // ==================== DATE VALIDATION ====================
    
    function validateDates() {
      const fromDate = document.getElementById('fromDate').value;
      const toDate = document.getElementById('toDate').value;
      const fromInput = document.getElementById('fromDate');
      const toInput = document.getElementById('toDate');
      const errorMessage = document.getElementById('dateErrorMessage');
      const applyButton = document.getElementById('applyButton');
      
      if (fromDate &amp;&amp; toDate) {
        if (fromDate &gt; toDate) {
          // Invalid date range
          fromInput.classList.add('error');
          toInput.classList.add('error');
          errorMessage.style.display = 'flex';
          applyButton.disabled = true;
          return false;
        } else {
          // Valid date range
          fromInput.classList.remove('error');
          toInput.classList.remove('error');
          errorMessage.style.display = 'none';
          applyButton.disabled = false;
          return true;
        }
      }
      return true;
    }
    
    function showStatus(message, type) {
      const statusEl = document.getElementById('statusMessage');
      statusEl.innerHTML = `&lt;i class=&quot;fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}&quot;&gt;&lt;/i&gt; ${message}`;
      statusEl.className = 'status-message status-' + type;
      statusEl.style.display = 'block';
      
      setTimeout(() =&gt; {
        statusEl.style.display = 'none';
      }, 3000);
    }
    
    // ==================== LOAD FILTER OPTIONS AND INITIAL DATA ====================
    
    function loadFilterOptions() {
      showLoader();
      
      google.script.run
        .withSuccessHandler((options) =&gt; {
          console.log('Filter options loaded:', options);
          allFilterOptions = options;
          allRelationships = options.relationships || [];
          
          populateDropdown('projectFilter', options.projects, 'Projects');
          populateDropdown('managerFilter', options.managers, 'Managers');
          populateDropdown('s4Filter', options.s4s, 'S4');
          
          loadAllEmployeesData();
        })
        .withFailureHandler((error) =&gt; {
          console.error('Error loading filters:', error);
          showStatus('Error loading filters: ' + error, 'error');
          hideLoader();
        })
        .getFilterOptions();
    }
    
    function populateDropdown(dropdownId, items, label) {
      const select = document.getElementById(dropdownId);
      
      if (!items || items.length === 0) {
        select.innerHTML = '&lt;option value=&quot;ALL&quot;&gt;No ' + label + ' found&lt;/option&gt;';
        return;
      }
      
      let html = '&lt;option value=&quot;ALL&quot;&gt;All ' + label + '&lt;/option&gt;';
      
      items.forEach(item =&gt; {
        if (item &amp;&amp; item.trim() !== '') {
          html += `&lt;option value=&quot;${item}&quot;&gt;${item}&lt;/option&gt;`;
        }
      });
      
      select.innerHTML = html;
    }
    
    function loadAllEmployeesData() {
      google.script.run
        .withSuccessHandler((data) =&gt; {
          console.log('All employees data loaded:', data.length, 'records');
          currentData = data;
          currentPage = 1;
          
          displayData(data);
          hideCharts();
          hideLoader();
        })
        .withFailureHandler((error) =&gt; {
          console.error('Error loading all employees:', error);
          hideLoader();
        })
        .getProductionData({});
    }
    
    function hideCharts() {
      chartsVisible = false;
      document.getElementById('mainContent').classList.remove('with-charts');
      document.getElementById('chartsSection').classList.remove('visible');
      document.getElementById('applyHint').style.display = 'flex';
    }
    
    function showCharts() {
      chartsVisible = true;
      document.getElementById('mainContent').classList.add('with-charts');
      document.getElementById('chartsSection').classList.add('visible');
      document.getElementById('applyHint').style.display = 'none';
    }
    
    function resetCharts() {
      document.getElementById('validationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;&lt;p&gt;Charts appear after clicking Apply&lt;/p&gt;&lt;/div&gt;';
      document.getElementById('verificationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;&lt;p&gt;Charts appear after clicking Apply&lt;/p&gt;&lt;/div&gt;';
    }
    
    // ==================== CASCADING FILTER LOGIC WITH AUTO-POPULATE ====================
    
    function updateFilterOptions(changed) {
      const project = document.getElementById('projectFilter').value;
      const manager = document.getElementById('managerFilter').value;
      const s4 = document.getElementById('s4Filter').value;
      
      console.log('Updating filter options:', { project, manager, s4, changed });
      
      currentFilters = { project, manager, s4 };
      
      document.getElementById('projectFilter').style.opacity = '0.7';
      document.getElementById('managerFilter').style.opacity = '0.7';
      document.getElementById('s4Filter').style.opacity = '0.7';
      
      google.script.run
        .withSuccessHandler((options) =&gt; {
          console.log('Filtered options received:', options);
          
          document.getElementById('projectFilter').classList.remove('auto-populated');
          document.getElementById('managerFilter').classList.remove('auto-populated');
          document.getElementById('s4Filter').classList.remove('auto-populated');
          
          if (changed !== 'project') {
            updateDropdownOptions('projectFilter', options.projects, currentFilters.project);
          }
          if (changed !== 'manager') {
            updateDropdownOptions('managerFilter', options.managers, currentFilters.manager);
          }
          if (changed !== 's4') {
            updateDropdownOptions('s4Filter', options.s4s, currentFilters.s4);
          }
          
          autoPopulateFilters(options, changed);
          
          document.getElementById('projectFilter').style.opacity = '1';
          document.getElementById('managerFilter').style.opacity = '1';
          document.getElementById('s4Filter').style.opacity = '1';
          
          showStatus('Filter options updated. Click Apply to generate charts.', 'success');
        })
        .withFailureHandler((error) =&gt; {
          console.error('Error getting filtered options:', error);
          document.getElementById('projectFilter').style.opacity = '1';
          document.getElementById('managerFilter').style.opacity = '1';
          document.getElementById('s4Filter').style.opacity = '1';
        })
        .getFilteredOptions(
          project === 'ALL' ? null : project,
          manager === 'ALL' ? null : manager,
          s4 === 'ALL' ? null : s4
        );
    }
    
    function autoPopulateFilters(options, changed) {
      if (changed !== 'project' &amp;&amp; options.projects &amp;&amp; options.projects.length === 1) {
        const singleProject = options.projects[0];
        document.getElementById('projectFilter').value = singleProject;
        document.getElementById('projectFilter').classList.add('auto-populated');
        document.getElementById('projectAutoHint').innerHTML = `&lt;i class=&quot;fas fa-check-circle&quot;&gt;&lt;/i&gt; Auto-selected: ${singleProject}`;
        currentFilters.project = singleProject;
      } else {
        document.getElementById('projectAutoHint').innerHTML = '';
      }
      
      if (changed !== 'manager' &amp;&amp; options.managers &amp;&amp; options.managers.length === 1) {
        const singleManager = options.managers[0];
        document.getElementById('managerFilter').value = singleManager;
        document.getElementById('managerFilter').classList.add('auto-populated');
        document.getElementById('managerAutoHint').innerHTML = `&lt;i class=&quot;fas fa-check-circle&quot;&gt;&lt;/i&gt; Auto-selected: ${singleManager}`;
        currentFilters.manager = singleManager;
      } else {
        document.getElementById('managerAutoHint').innerHTML = '';
      }
      
      if (changed !== 's4' &amp;&amp; options.s4s &amp;&amp; options.s4s.length === 1) {
        const singleS4 = options.s4s[0];
        document.getElementById('s4Filter').value = singleS4;
        document.getElementById('s4Filter').classList.add('auto-populated');
        document.getElementById('s4AutoHint').innerHTML = `&lt;i class=&quot;fas fa-check-circle&quot;&gt;&lt;/i&gt; Auto-selected: ${singleS4}`;
        currentFilters.s4 = singleS4;
      } else {
        document.getElementById('s4AutoHint').innerHTML = '';
      }
    }
    
    function updateDropdownOptions(dropdownId, options, selectedValue) {
      const select = document.getElementById(dropdownId);
      const label = dropdownId === 'projectFilter' ? 'Projects' : 
                    dropdownId === 'managerFilter' ? 'Managers' : 'S4';
      
      if (!options || options.length === 0) {
        select.innerHTML = '&lt;option value=&quot;ALL&quot;&gt;No ' + label + ' available&lt;/option&gt;';
        return;
      }
      
      let html = '&lt;option value=&quot;ALL&quot;&gt;All ' + label + '&lt;/option&gt;';
      
      options.forEach(option =&gt; {
        if (option &amp;&amp; option.trim() !== '') {
          const selected = (option === selectedValue) ? 'selected' : '';
          html += `&lt;option value=&quot;${option}&quot; ${selected}&gt;${option}&lt;/option&gt;`;
        }
      });
      
      select.innerHTML = html;
    }
    
    // ==================== APPLY FILTERS ====================
    
    function applyFilters() {
      // First validate dates
      if (!validateDates()) {
        showStatus('Please fix date range before applying filters', 'error');
        return;
      }
      
      showLoader();
      
      const filters = {
        project: document.getElementById('projectFilter').value,
        manager: document.getElementById('managerFilter').value,
        s4: document.getElementById('s4Filter').value,
        fromDate: document.getElementById('fromDate').value,
        toDate: document.getElementById('toDate').value
      };
      
      console.log('APPLY button clicked - refreshing data with filters:', filters);
      
      const backendFilters = {
        project: filters.project === 'ALL' ? null : filters.project,
        manager: filters.manager === 'ALL' ? null : filters.manager,
        s4: filters.s4 === 'ALL' ? null : filters.s4,
        fromDate: filters.fromDate,
        toDate: filters.toDate
      };
      
      google.script.run
        .withSuccessHandler((data) =&gt; {
          console.log('Filtered data received:', data.length, 'records');
          currentData = data;
          currentPage = 1;
          
          displayData(data);
          
          if (data.length &gt; 0) {
            updateCharts(data);
            showCharts();
          } else {
            document.getElementById('validationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;&lt;p&gt;No data available for charts&lt;/p&gt;&lt;/div&gt;';
            document.getElementById('verificationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;&lt;p&gt;No data available for charts&lt;/p&gt;&lt;/div&gt;';
            showCharts();
          }
          
          showStatus(`Found ${data.length} records`, 'success');
          hideLoader();
        })
        .withFailureHandler((error) =&gt; {
          console.error('Error applying filters:', error);
          showStatus('Error applying filters: ' + error, 'error');
          hideLoader();
        })
        .getProductionData(backendFilters);
    }
    
    function clearFilters() {
      document.getElementById('projectFilter').value = 'ALL';
      document.getElementById('managerFilter').value = 'ALL';
      document.getElementById('s4Filter').value = 'ALL';
      
      document.getElementById('projectFilter').classList.remove('auto-populated');
      document.getElementById('managerFilter').classList.remove('auto-populated');
      document.getElementById('s4Filter').classList.remove('auto-populated');
      document.getElementById('projectAutoHint').innerHTML = '';
      document.getElementById('managerAutoHint').innerHTML = '';
      document.getElementById('s4AutoHint').innerHTML = '';
      
      setDefaultDates();
      validateDates(); // Re-validate after setting dates
      
      currentFilters = { project: 'ALL', manager: 'ALL', s4: 'ALL' };
      
      google.script.run
        .withSuccessHandler((options) =&gt; {
          populateDropdown('projectFilter', options.projects, 'Projects');
          populateDropdown('managerFilter', options.managers, 'Managers');
          populateDropdown('s4Filter', options.s4s, 'S4');
          
          loadAllEmployeesData();
          hideCharts();
          resetCharts();
          
          showStatus('Filters cleared. Showing all employees.', 'success');
        })
        .getFilterOptions();
    }
    
    // ==================== DISPLAY FUNCTIONS ====================
    
    function displayData(data) {
      const tbody = document.getElementById('tableBody');
      const recordCount = document.getElementById('recordCount');
      
      recordCount.textContent = `${data.length} records`;
      
      if (data.length === 0) {
        tbody.innerHTML = '&lt;tr&gt;&lt;td colspan=&quot;6&quot; class=&quot;no-data&quot;&gt;&lt;i class=&quot;fas fa-exclamation-circle&quot;&gt;&lt;/i&gt; No data found&lt;/td&gt;&lt;/tr&gt;';
        document.getElementById('pagination').innerHTML = '';
        return;
      }
      
      const start = (currentPage - 1) * rowsPerPage;
      const end = Math.min(start + rowsPerPage, data.length);
      const pageData = data.slice(start, end);
      
      let html = '';
      pageData.forEach(emp =&gt; {
        const empProject = emp.project || findEmployeeProject(emp.name) || 'N/A';
        
        html += `
          &lt;tr&gt;
            &lt;td&gt;&lt;span class=&quot;project-badge&quot;&gt;&lt;i class=&quot;fas fa-folder&quot; style=&quot;margin-right: 4px;&quot;&gt;&lt;/i&gt; ${empProject}&lt;/span&gt;&lt;/td&gt;
            &lt;td&gt;&lt;strong&gt;${emp.name}&lt;/strong&gt;&lt;/td&gt;
            &lt;td&gt;${emp.valiCount || 0}&lt;/td&gt;
            &lt;td&gt;${(emp.valiHours || 0).toFixed(1)}&lt;/td&gt;
            &lt;td&gt;${emp.veriCount || 0}&lt;/td&gt;
            &lt;td&gt;${(emp.veriHours || 0).toFixed(1)}&lt;/td&gt;
          &lt;/tr&gt;
        `;
      });
      
      tbody.innerHTML = html;
      updatePagination(data.length);
    }
    
    function findEmployeeProject(employeeName) {
      if (!allRelationships || allRelationships.length === 0) {
        return 'TRICORBRAUN';
      }
      
      const rel = allRelationships.find(r =&gt; r.employee === employeeName);
      return rel ? rel.project : 'TRICORBRAUN';
    }
    
    function updatePagination(totalRows) {
      const totalPages = Math.ceil(totalRows / rowsPerPage);
      const pagination = document.getElementById('pagination');
      
      if (totalPages &lt;= 1) {
        pagination.innerHTML = '';
        return;
      }
      
      let html = `&lt;button class=&quot;page-btn&quot; onclick=&quot;changePage('prev')&quot; ${currentPage === 1 ? 'disabled' : ''}&gt;&lt;i class=&quot;fas fa-chevron-left&quot;&gt;&lt;/i&gt;&lt;/button&gt;`;
      
      const startPage = Math.max(1, currentPage - 2);
      const endPage = Math.min(totalPages, startPage + 4);
      
      for (let i = startPage; i &lt;= endPage; i++) {
        html += `&lt;button class=&quot;page-btn ${i === currentPage ? 'active' : ''}&quot; onclick=&quot;changePage(${i})&quot;&gt;${i}&lt;/button&gt;`;
      }
      
      if (endPage &lt; totalPages) {
        html += `&lt;span class=&quot;page-btn&quot; style=&quot;background: transparent; border: none;&quot;&gt;...&lt;/span&gt;`;
        html += `&lt;button class=&quot;page-btn&quot; onclick=&quot;changePage(${totalPages})&quot;&gt;${totalPages}&lt;/button&gt;`;
      }
      
      html += `&lt;button class=&quot;page-btn&quot; onclick=&quot;changePage('next')&quot; ${currentPage === totalPages ? 'disabled' : ''}&gt;&lt;i class=&quot;fas fa-chevron-right&quot;&gt;&lt;/i&gt;&lt;/button&gt;`;
      
      pagination.innerHTML = html;
    }
    
    function changePage(page) {
      const totalPages = Math.ceil(currentData.length / rowsPerPage);
      
      if (page === 'prev') {
        currentPage = Math.max(1, currentPage - 1);
      } else if (page === 'next') {
        currentPage = Math.min(totalPages, currentPage + 1);
      } else {
        currentPage = page;
      }
      
      displayData(currentData);
    }
    
    // ==================== CHART FUNCTIONS ====================
    
    function updateCharts(data) {
      if (!data || data.length === 0) {
        document.getElementById('validationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;&lt;p&gt;No data available for charts&lt;/p&gt;&lt;/div&gt;';
        document.getElementById('verificationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-chart-bar&quot; style=&quot;font-size: 32px; margin-bottom: 10px; opacity: 0.3;&quot;&gt;&lt;/i&gt;&lt;p&gt;No data available for charts&lt;/p&gt;&lt;/div&gt;';
        return;
      }
      
      const validationData = data.map(emp =&gt; ({
        name: emp.name,
        count: emp.valiCount || 0,
        hours: emp.valiHours || 0
      }));
      
      const verificationData = data.map(emp =&gt; ({
        name: emp.name,
        count: emp.veriCount || 0,
        hours: emp.veriHours || 0
      }));
      
      drawValidationChart(validationData);
      drawVerificationChart(verificationData);
    }
    
    function drawValidationChart(data) {
      try {
        const chartContainer = document.getElementById('validationChart');
        chartContainer.innerHTML = '';
        
        const sortedData = [...data].sort((a, b) =&gt; b.count - a.count).slice(0, 8);
        
        const chartData = new google.visualization.DataTable();
        chartData.addColumn('string', 'Employee');
        chartData.addColumn('number', 'Count');
        chartData.addColumn('number', 'Hours');
        
        sortedData.forEach(item =&gt; {
          const displayName = item.name.length &gt; 15 ? item.name.substring(0, 12) + '...' : item.name;
          chartData.addRow([displayName, item.count, item.hours]);
        });
        
        const options = {
          title: 'Validation Production (Top 8)',
          titleTextStyle: { fontSize: 13, bold: true },
          chartArea: { 
            left: 70,      
            top: 40,       
            right: 20,     
            bottom: 90,
            width: '70%',
            height: '55%'
          },
          hAxis: { 
            title: 'Employees',
            titleTextStyle: { fontSize: 11, italic: true },
            slantedText: true,
            slantedTextAngle: 25,
            textStyle: { fontSize: 9 },
            showTextEvery: 1,
            maxAlternation: 1
          },
          vAxis: { 
            title: 'Values',
            titleTextStyle: { fontSize: 11, italic: true },
            textStyle: { fontSize: 9 },
            gridlines: { count: 4 }
          },
          seriesType: 'bars',
          series: { 
            0: { type: 'bars', color: '#667eea' },
            1: { type: 'line', color: '#ff4757', lineWidth: 2 }
          },
          legend: { 
            position: 'top',
            alignment: 'center',
            textStyle: { fontSize: 11 }
          },
          height: 240,
          width: '100%',
          tooltip: { 
            showColorCode: true,
            textStyle: { fontSize: 11 }
          },
          bar: { groupWidth: '70%' }
        };
        
        const chart = new google.visualization.ComboChart(chartContainer);
        chart.draw(chartData, options);
        
      } catch (error) {
        console.error('Error drawing validation chart:', error);
        document.getElementById('validationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-exclamation-circle&quot;&gt;&lt;/i&gt; Error drawing chart&lt;/div&gt;';
      }
    }
    
    function drawVerificationChart(data) {
      try {
        const chartContainer = document.getElementById('verificationChart');
        chartContainer.innerHTML = '';
        
        const sortedData = [...data].sort((a, b) =&gt; b.count - a.count).slice(0, 8);
        
        const chartData = new google.visualization.DataTable();
        chartData.addColumn('string', 'Employee');
        chartData.addColumn('number', 'Count');
        chartData.addColumn('number', 'Hours');
        
        sortedData.forEach(item =&gt; {
          const displayName = item.name.length &gt; 15 ? item.name.substring(0, 12) + '...' : item.name;
          chartData.addRow([displayName, item.count, item.hours]);
        });
        
        const options = {
          title: 'Verification Production (Top 8)',
          titleTextStyle: { fontSize: 13, bold: true },
          chartArea: { 
            left: 70,      
            top: 40,       
            right: 20,     
            bottom: 90,
            width: '70%',
            height: '55%'
          },
          hAxis: { 
            title: 'Employees',
            titleTextStyle: { fontSize: 11, italic: true },
            slantedText: true,
            slantedTextAngle: 25,
            textStyle: { fontSize: 9 },
            showTextEvery: 1,
            maxAlternation: 1
          },
          vAxis: { 
            title: 'Values',
            titleTextStyle: { fontSize: 11, italic: true },
            textStyle: { fontSize: 9 },
            gridlines: { count: 4 }
          },
          seriesType: 'bars',
          series: { 
            0: { type: 'bars', color: '#4CAF50' },
            1: { type: 'line', color: '#2196F3', lineWidth: 2 }
          },
          legend: { 
            position: 'top',
            alignment: 'center',
            textStyle: { fontSize: 11 }
          },
          height: 240,
          width: '100%',
          tooltip: { 
            showColorCode: true,
            textStyle: { fontSize: 11 }
          },
          bar: { groupWidth: '70%' }
        };
        
        const chart = new google.visualization.ComboChart(chartContainer);
        chart.draw(chartData, options);
        
      } catch (error) {
        console.error('Error drawing verification chart:', error);
        document.getElementById('verificationChart').innerHTML = '&lt;div class=&quot;chart-placeholder&quot;&gt;&lt;i class=&quot;fas fa-exclamation-circle&quot;&gt;&lt;/i&gt; Error drawing chart&lt;/div&gt;';
      }
    }
    
    // ==================== LOADER FUNCTIONS ====================
    
    function showLoader() {
      document.getElementById('loader').style.display = 'block';
      document.getElementById('tableContainer').style.opacity = '0.5';
    }
    
    function hideLoader() {
      document.getElementById('loader').style.display = 'none';
      document.getElementById('tableContainer').style.opacity = '1';
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></p>
<h1>PULSE WEB APP - COMPLETE PROMPT</h1>
<p>Create a Google Apps Script web application called "Pulse" that tracks and filters production data with the following specifications:</p>
<h1>GOOGLE SHEETS INTEGRATION</h1>
<p>The app will connect to THREE Google Sheets. Replace the placeholder IDs with your actual Google Sheet IDs:</p>
<li><ul>LIST_SHEET_ID = 'PASTE_YOUR_LIST_SHEET_ID_HERE'</ul>
<ul>CONSOLIDATED_SHEET_ID = 'PASTE_YOUR_CONSOLIDATED_SHEET_ID_HERE'
</ul>
<ul>LOG_SHEET_ID = 'PASTE_YOUR_LOG_SHEET_ID_HERE'
</ul></li>
<p><b>Sheet Structures Required:<br><br>
<b>Sheet Name: 'List' (Employee Hierarchy)<br><br>

Column A: Project<br><br>

Column B: Manager<br><br>

Column C: S4<br><br>

Column D: Employee Name<br><br>

<b>Sheet Name: 'CONSOLIDATED' (Validation/Verification Counts)<br><br>

Column A: Date<br><br>

Column B: NAME (Employee Name)<br><br>

Column C: INVOICE NUMBER<br><br>

Column D: PAGES<br><br>

Column E: DOCUMENT<br><br>

Column F: VALIDATION/VERIFICATION (values: "VALIDATION" or "VERIFICATION")<br><br>

<b>Sheet Name: 'LOG' (Production Hours)<br><br>

Column A: Date<br><br>

Column B: NAME (Employee Name)<br><br>

Column C: ACTIVITY (should be "Production")<br><br>

Column D: NOTES (contains "TRICOR-VALI" or "TRICOR-VERI" patterns)<br><br>

Column E: HOURS<br><br>

<b>CORE FUNCTIONALITY<br><br>
<b>1. Cascading Filters<br><br>
Project Dropdown: Shows all projects from 'List' sheet<br><br>

Manager Dropdown: Shows managers filtered by selected Project<br><br>

S4 Dropdown: Shows S4 filtered by selected Project and Manager<br><br>

<b>Filter Logic:<br><br>

Selecting a Project  Show only Managers and S4s under that Project<br><br>

Selecting a Manager  Show only Projects they manage and S4s under them<br><br>

Selecting an S4  Show only Projects and Managers associated with that S4<br><br>

<b>Auto-populate Feature:<br><br>

When any filter has ONLY ONE available option, automatically select it <br><br>

Visually highlight auto-populated fields with light blue background <br><br>

Show hint text: " Auto-selected: [value]" <br><br>

<b>2. Date Range Picker<br><br>
Two date inputs: "From" and "To" <br><br>

Default to today's date on both fields<br><br>

Validate that "From" date is not later than "To" date<br><br>

Show error message and disable Apply button when dates are invalid<br><br>

<b>3. Action Buttons<br><br>
Apply Button: Triggers data refresh, updates table, and shows charts <br><br>

Clear Button: Resets all filters to "All Projects/Managers/S4", resets dates to today, hides charts, returns to full-width table <br><br>

<b>4. Data Table<br><br>
Columns: PROJECT, Name, Vali Prod Count, Vali Prod Hours, Veri Prod Count, Veri Prod Hours <br><br>

Show all employees by default on landing page<br><br>

Pagination: 10 rows per page with Previous/Next buttons and page numbers<br><br>

Project badges with folder icon<br><br>

<b>5. Charts<br><br>
Two combo charts (bars + line) on the right side:<br><br>

Validation Chart: Vali Prod Count (bars) and Vali Prod Hours (line)<br><br>

Verification Chart: Veri Prod Count (bars) and Veri Prod Hours (line)<br><br>

Charts ONLY appear after clicking Apply button<br><br>

Show top 8 employees sorted by count<br><br>

Employee names displayed at bottom (slanted at 25 degrees)<br><br>

Tooltips show exact values on hover<br><br>

Placeholder text when charts are hidden<br><br>

<b>6. Layout States<br><br>
Landing Page: Full-width table, charts hidden, "Click Apply to generate charts" hint visible<br><br>

After Apply: Split layout with table on left, charts on right (400px width)<br><br>

<b>UI DESIGN REQUIREMENTS<br><br>
Color Scheme<br><br>
Body background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)<br><br>

Container background: White<br><br>

Primary button: Gradient #667eea to #764ba2<br><br>

Secondary button: #ff4757<br><br>

Table header: Same gradient as primary button<br><br>

Auto-populated fields: #e8f0fe with blue border<br><br>

Icons (Font Awesome)<br><br>
Project: i class="fas fa-folder"i<br><br>

Manager: i class="fas fa-user-tie"i<br><br>

S4: i class="fas fa-building">i<br><br>

Date From: i class="fas fa-calendar-plus"i<br><br>

Date To: i class="fas fa-calendar-check"i<br><br>

Apply: i class="fas fa-check"i<br><br>

Clear: i class="fas fa-times"i<br><br>

Responsive Design<br><br>
Desktop: 4-column filter grid<br><br>

Tablet: 2-column filter grid<br><br>

Mobile: 1-column stacked layout<br><br>

Charts stack below table on smaller screens<br><br>

TESTING SCENARIOS TO VERIFY<br><br>
One Manager, Multiple Projects - Select a manager who handles multiple projects<br><br>

One Project, Multiple Managers - Select a project with multiple managers<br><br>

One Manager, One Project, Multiple S4s - Select manager/project combination with multiple S4s<br><br>

One S4, Multiple Projects and Managers - Select an S4 used across different projects<br><br>

Auto-populate - Select options that leave only one choice in another filter<br><br>

<b>DELIVERABLES<br><br>
Provide two complete files:<br><br>

Code.gs - Backend Google Apps Script with:<br><br>

Sheet ID configuration section<br><br>

Filter options functions<br><br>

Data fetching functions<br><br>

Placeholder calculation functions<br><br>

Test data for development<br><br>

Index.html - Frontend with:<br><br>

Complete CSS styling<br><br>

Cascading filter logic with auto-populate<br><br>

Date validation<br><br>

Data table with pagination<br><br>

Google Charts integration<br><br>

Responsive design<br><br>

All icons and visual elements<br><br>

IMPLEMENTATION NOTES<br><br>
The calculation logic needs confirmation, so create placeholder functions<br><br>

Test data is provided for development until real sheets are connected<br><br>

All three Google Sheet IDs must be replaced by the user<br><br>

The app should work immediately with test data before real integration<br><br>
</p>

<h1>CODEGS</h1>
<p>// Google Sheet IDs (replace with your actual IDs)
const LIST_SHEET_ID = '170CORmjNk__GrTOwm06KuMaR9JrbFFUkAbn921B-pKA';
const CONSOLIDATED_SHEET_ID = '170CORmjNk__GrTOwm06KuMaR9JrbFFUkAbn921B-pKA';
const LOG_SHEET_ID = '170CORmjNk__GrTOwm06KuMaR9JrbFFUkAbn921B-pKA';

function doGet() {
  return HtmlService.createHtmlOutputFromFile('Index')
      .setTitle('Pulse - Production Tracker')
      .setFaviconUrl('https://www.google.com/favicon.ico')
      .addMetaTag('viewport', 'width=device-width, initial-scale=1')
      .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}

// ==================== FILTER DATA FUNCTIONS ====================

// Get all filter options from List sheet
function getFilterOptions() {
  try {
    // For testing, use the sample data to build filter options
    const sampleData = getSampleData();
    
    const projects = new Set();
    const managers = new Set();
    const s4s = new Set();
    const employees = [];
    const relationships = [];
    
    sampleData.forEach(emp => {
      if (emp.project) projects.add(emp.project);
      if (emp.manager) managers.add(emp.manager);
      if (emp.s4) s4s.add(emp.s4);
      
      employees.push({
        name: emp.name,
        project: emp.project,
        manager: emp.manager,
        s4: emp.s4
      });
      
      relationships.push({
        project: emp.project,
        manager: emp.manager,
        s4: emp.s4,
        employee: emp.name
      });
    });
    
    return {
      projects: Array.from(projects).sort(),
      managers: Array.from(managers).sort(),
      s4s: Array.from(s4s).sort(),
      employees: employees,
      relationships: relationships
    };
  } catch (error) {
    return {
      projects: ['TRICORBRAUN', 'PROJECT A', 'PROJECT B', 'PROJECT C', 'PROJECT D', 'PROJECT E'],
      managers: ['John Manager', 'Jane Manager', 'Bob Manager', 'Alice Manager', 'Mike Manager', 'Sarah Manager'],
      s4s: ['S4-001', 'S4-002', 'S4-003', 'S4-004', 'S4-005', 'S4-006', 'S4-007', 'S4-008'],
      employees: [],
      relationships: []
    };
  }
}

// ==================== CASCADING FILTER FUNCTIONS ====================

// Get filtered options based on selected filters
function getFilteredOptions(selectedProject, selectedManager, selectedS4) {
  try {
    const sampleData = getSampleData();
    
    const projects = new Set();
    const managers = new Set();
    const s4s = new Set();
    const employees = new Set();
    
    sampleData.forEach(emp => {
      let include = true;
      
      if (selectedProject && selectedProject !== 'ALL' && selectedProject !== '' && emp.project !== selectedProject) {
        include = false;
      }
      if (selectedManager && selectedManager !== 'ALL' && selectedManager !== '' && emp.manager !== selectedManager) {
        include = false;
      }
      if (selectedS4 && selectedS4 !== 'ALL' && selectedS4 !== '' && emp.s4 !== selectedS4) {
        include = false;
      }
      
      if (include) {
        if (emp.project) projects.add(emp.project);
        if (emp.manager) managers.add(emp.manager);
        if (emp.s4) s4s.add(emp.s4);
        if (emp.name) employees.add(emp.name);
      }
    });
    
    return {
      projects: Array.from(projects).sort(),
      managers: Array.from(managers).sort(),
      s4s: Array.from(s4s).sort(),
      employees: Array.from(employees).sort()
    };
  } catch (error) {
    return {
      projects: ['TRICORBRAUN', 'PROJECT A', 'PROJECT B', 'PROJECT C', 'PROJECT D', 'PROJECT E'],
      managers: ['John Manager', 'Jane Manager', 'Bob Manager', 'Alice Manager', 'Mike Manager', 'Sarah Manager'],
      s4s: ['S4-001', 'S4-002', 'S4-003', 'S4-004', 'S4-005', 'S4-006', 'S4-007', 'S4-008'],
      employees: []
    };
  }
}

// ==================== DATA CALCULATION FUNCTIONS ====================

// Get production data for employees with filters
function getProductionData(filters) {
  try {
    let filteredData = getSampleData();
    
    // Apply filters if they exist
    if (filters) {
      if (filters.project && filters.project !== 'ALL' && filters.project !== null) {
        filteredData = filteredData.filter(emp => emp.project === filters.project);
      }
      if (filters.manager && filters.manager !== 'ALL' && filters.manager !== null) {
        filteredData = filteredData.filter(emp => emp.manager === filters.manager);
      }
      if (filters.s4 && filters.s4 !== 'ALL' && filters.s4 !== null) {
        filteredData = filteredData.filter(emp => emp.s4 === filters.s4);
      }
    }
    
    return filteredData;
  } catch (error) {
    console.error('Error getting production data:', error);
    return getSampleData();
  }
}

// Get sample data covering ALL possible cascading scenarios
function getSampleData() {
  return [
    // ==================== SCENARIO 1: One Manager, Multiple Projects ====================
    // John Manager handles 3 different projects
    { name: 'John Ric Vista', project: 'TRICORBRAUN', manager: 'John Manager', s4: 'S4-001', valiCount: 75, veriCount: 50, valiHours: 3.5, veriHours: 0.8 },
    { name: 'Maria Santos', project: 'TRICORBRAUN', manager: 'John Manager', s4: 'S4-001', valiCount: 82, veriCount: 45, valiHours: 4.2, veriHours: 1.1 },
    { name: 'Robert Lee', project: 'PROJECT X', manager: 'John Manager', s4: 'S4-002', valiCount: 57, veriCount: 41, valiHours: 2.8, veriHours: 0.7 },
    { name: 'Ana Garcia', project: 'PROJECT X', manager: 'John Manager', s4: 'S4-002', valiCount: 88, veriCount: 55, valiHours: 4.0, veriHours: 1.2 },
    { name: 'Michael Brown', project: 'PROJECT Y', manager: 'John Manager', s4: 'S4-003', valiCount: 92, veriCount: 61, valiHours: 4.6, veriHours: 1.5 },
    { name: 'Jennifer Taylor', project: 'PROJECT Y', manager: 'John Manager', s4: 'S4-003', valiCount: 78, veriCount: 48, valiHours: 3.7, veriHours: 1.0 },
    
    // ==================== SCENARIO 2: One Project, Multiple Managers ====================
    // PROJECT A has 3 different managers
    { name: 'David Chen', project: 'PROJECT A', manager: 'Jane Manager', s4: 'S4-004', valiCount: 63, veriCount: 38, valiHours: 3.0, veriHours: 0.9 },
    { name: 'Sarah Johnson', project: 'PROJECT A', manager: 'Jane Manager', s4: 'S4-004', valiCount: 91, veriCount: 62, valiHours: 4.5, veriHours: 1.3 },
    { name: 'Mike Chen', project: 'PROJECT A', manager: 'Bob Manager', s4: 'S4-005', valiCount: 69, veriCount: 44, valiHours: 3.2, veriHours: 0.9 },
    { name: 'Lisa Wong', project: 'PROJECT A', manager: 'Bob Manager', s4: 'S4-005', valiCount: 94, veriCount: 58, valiHours: 4.8, veriHours: 1.4 },
    { name: 'Tom Bradley', project: 'PROJECT A', manager: 'Alice Manager', s4: 'S4-006', valiCount: 71, veriCount: 47, valiHours: 3.6, veriHours: 1.0 },
    { name: 'Emma Davis', project: 'PROJECT A', manager: 'Alice Manager', s4: 'S4-006', valiCount: 79, veriCount: 52, valiHours: 4.1, veriHours: 1.2 },
    
    // ==================== SCENARIO 3: One Manager, One Project, Multiple S4s ====================
    // PROJECT B with Mike Manager and 3 S4s
    { name: 'James Wilson', project: 'PROJECT B', manager: 'Mike Manager', s4: 'S4-007', valiCount: 83, veriCount: 49, valiHours: 3.9, veriHours: 1.1 },
    { name: 'Elizabeth Davis', project: 'PROJECT B', manager: 'Mike Manager', s4: 'S4-007', valiCount: 71, veriCount: 47, valiHours: 3.6, veriHours: 1.0 },
    { name: 'Thomas Martinez', project: 'PROJECT B', manager: 'Mike Manager', s4: 'S4-008', valiCount: 79, veriCount: 52, valiHours: 4.1, veriHours: 1.2 },
    { name: 'Susan Rodriguez', project: 'PROJECT B', manager: 'Mike Manager', s4: 'S4-008', valiCount: 64, veriCount: 42, valiHours: 3.2, veriHours: 0.8 },
    { name: 'Patricia Moore', project: 'PROJECT B', manager: 'Mike Manager', s4: 'S4-009', valiCount: 67, veriCount: 43, valiHours: 3.3, veriHours: 0.9 },
    { name: 'Michael Brown', project: 'PROJECT B', manager: 'Mike Manager', s4: 'S4-009', valiCount: 92, veriCount: 61, valiHours: 4.6, veriHours: 1.5 },
    
    // ==================== SCENARIO 4: One S4, Multiple Projects and Managers ====================
    // S4-010 is used across different projects and managers
    { name: 'Jennifer Taylor', project: 'PROJECT C', manager: 'Sarah Manager', s4: 'S4-010', valiCount: 78, veriCount: 48, valiHours: 3.7, veriHours: 1.0 },
    { name: 'William Anderson', project: 'PROJECT C', manager: 'Sarah Manager', s4: 'S4-010', valiCount: 86, veriCount: 54, valiHours: 4.2, veriHours: 1.2 },
    { name: 'Robert Johnson', project: 'PROJECT D', manager: 'Mike Manager', s4: 'S4-010', valiCount: 73, veriCount: 46, valiHours: 3.8, veriHours: 1.1 },
    { name: 'Linda Williams', project: 'PROJECT D', manager: 'Mike Manager', s4: 'S4-010', valiCount: 81, veriCount: 53, valiHours: 4.3, veriHours: 1.3 },
    { name: 'Richard Brown', project: 'PROJECT E', manager: 'Jane Manager', s4: 'S4-010', valiCount: 77, veriCount: 51, valiHours: 3.9, veriHours: 1.2 },
    { name: 'Susan Miller', project: 'PROJECT E', manager: 'Jane Manager', s4: 'S4-010', valiCount: 84, veriCount: 57, valiHours: 4.4, veriHours: 1.4 },
    
    // ==================== SCENARIO 5: Complex Relationships ====================
    // Mix of different relationships to test all combinations
    { name: 'David Wilson', project: 'PROJECT F', manager: 'Alice Manager', s4: 'S4-011', valiCount: 68, veriCount: 44, valiHours: 3.4, veriHours: 0.9 },
    { name: 'Sarah Lee', project: 'PROJECT F', manager: 'Alice Manager', s4: 'S4-011', valiCount: 87, veriCount: 56, valiHours: 4.3, veriHours: 1.3 },
    { name: 'Michael Zhang', project: 'PROJECT F', manager: 'Bob Manager', s4: 'S4-012', valiCount: 76, veriCount: 49, valiHours: 3.8, veriHours: 1.1 },
    { name: 'Lisa Chen', project: 'PROJECT G', manager: 'Bob Manager', s4: 'S4-012', valiCount: 89, veriCount: 59, valiHours: 4.5, veriHours: 1.4 },
    { name: 'James Taylor', project: 'PROJECT G', manager: 'Sarah Manager', s4: 'S4-013', valiCount: 72, veriCount: 45, valiHours: 3.6, veriHours: 1.0 },
    { name: 'Maria Garcia', project: 'PROJECT H', manager: 'Sarah Manager', s4: 'S4-013', valiCount: 85, veriCount: 55, valiHours: 4.2, veriHours: 1.3 },
    
    // ==================== SCENARIO 6: Auto-populate Tests (Single Options) ====================
    // PROJECT I has only one manager and one S4 (should auto-populate both)
    { name: 'Single Option 1', project: 'PROJECT I', manager: 'Solo Manager', s4: 'S4-014', valiCount: 95, veriCount: 65, valiHours: 4.9, veriHours: 1.6 },
    { name: 'Single Option 2', project: 'PROJECT I', manager: 'Solo Manager', s4: 'S4-014', valiCount: 88, veriCount: 58, valiHours: 4.4, veriHours: 1.4 },
    
    // MANAGER X has only one project and one S4 (should auto-populate)
    { name: 'Manager X Emp 1', project: 'PROJECT J', manager: 'Manager X', s4: 'S4-015', valiCount: 78, veriCount: 48, valiHours: 3.9, veriHours: 1.1 },
    { name: 'Manager X Emp 2', project: 'PROJECT J', manager: 'Manager X', s4: 'S4-015', valiCount: 82, veriCount: 52, valiHours: 4.1, veriHours: 1.2 },
    
    // S4-016 has only one project and one manager (should auto-populate)
    { name: 'S4 Only Emp 1', project: 'PROJECT K', manager: 'Manager Y', s4: 'S4-016', valiCount: 79, veriCount: 49, valiHours: 3.9, veriHours: 1.1 },
    { name: 'S4 Only Emp 2', project: 'PROJECT K', manager: 'Manager Y', s4: 'S4-016', valiCount: 83, veriCount: 53, valiHours: 4.2, veriHours: 1.3 }
  ];
}

// Get chart data
function getChartData(productionData) {
  const valiData = productionData.map(emp => ({
    name: emp.name,
    count: emp.valiCount,
    hours: emp.valiHours
  }));
  
  const veriData = productionData.map(emp => ({
    name: emp.name,
    count: emp.veriCount,
    hours: emp.veriHours
  }));
  
  return {
    validation: valiData,
    verification: veriData
  };
}</p>
</body>
</html>
